<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Separate Template for Rendering Forms &mdash; Python Notes 0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/css/customizations.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Python Notes 0 documentation" href="../../../index.html" />
    <link rel="up" title="mako" href="../../mako/mako.html" />
    <link rel="next" title="unittest" href="../../unittest/unittest.html" />
    <link rel="prev" title="Bootstrap Form Validation States" href="../pyramid_bootstrap/bootstrap_form_messages/bootstrap_form_messages.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="separate-template-for-rendering-forms">
<span id="form-as-separate-template"></span><h1>Separate Template for Rendering Forms<a class="headerlink" href="#separate-template-for-rendering-forms" title="Permalink to this headline">¶</a></h1>
<p>The way WTForms is set up, it&#8217;s easier to re-render the whole page to show errors to a form that failed server-side validation.</p>
<p>For small and lightweight pages, this isn&#8217;t much of an issue. However, for heavy pages with a lot of action and javascript, this might not be acceptable.</p>
<p>This is just one use case for housing the form in it&#8217;s own template &amp; view callable for AJAX calls.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This example builds off the following knowladge bases:</p>
<ul class="simple">
<li><a class="reference internal" href="../pyramid.html#pyramid"><span class="std std-ref">pyramid</span></a></li>
<li>jQuery</li>
<li><a class="reference internal" href="../../wtforms/wtforms.html#wtforms"><span class="std std-ref">WTForms</span></a></li>
</ul>
<p class="last">Understanding the above will improve the &#8220;brilliance&#8221; of this examples magic.</p>
</div>
<div class="section" id="form-html-snippets-as-templates">
<h2>Form HTML Snippets as Templates<a class="headerlink" href="#form-html-snippets-as-templates" title="Permalink to this headline">¶</a></h2>
<p>Below shows what this html snippet would look like with only the <code class="docutils literal"><span class="pre">firstname</span></code> field &amp; its errors rendered.</p>
<div class="literal-block-wrapper container" id="a-form-as-an-html-snippet-template">
<div class="code-block-caption"><span class="caption-text">A Form as an HTML Snippet Template</span><a class="headerlink" href="#a-form-as-an-html-snippet-template" title="Permalink to this code">¶</a></div>
<div class="highlight-mako"><div class="highlight"><pre><span></span><span class="x">&lt;form method=&quot;POST&quot; action=&quot;</span><span class="cp">${</span><span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">)</span><span class="cp">}</span><span class="x">&quot;&gt;</span>
<span class="x">  &lt;p&gt;</span><span class="cp">${</span><span class="n">message</span><span class="cp">}</span><span class="x">&lt;/p&gt;</span>

<span class="x">  </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">label</span><span class="cp">}</span><span class="x"> - </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="p">()</span><span class="cp">}</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
	  <span class="cp">%</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span><span class="cp">${</span><span class="n">error</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
	  <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">	&lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="x">  &lt;br/&gt;</span>

<span class="x">  &lt;input type=&quot;submit&quot; value=&quot;submit&quot;/&gt;</span>
<span class="x">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
<p>Again, the advantage is that based off the different states of the active form (empty, pre-populated, invalid, etc.), the form can be rendered in an existing page without having to reload the whole page &amp; it&#8217;s dependencies.</p>
</div>
<div class="section" id="the-view-callable-that-serves-the-form-html-snippet">
<h2>The View Callable That Serves the Form HTML Snippet<a class="headerlink" href="#the-view-callable-that-serves-the-form-html-snippet" title="Permalink to this headline">¶</a></h2>
<p>Since this form can be retrieved in a few different states (empty, invalid form data with errors, if you&#8217;re editing an existing item), a special view callable is made to handle the rendering of the form.</p>
<div class="literal-block-wrapper container" id="form-view-callable">
<div class="code-block-caption"><span class="caption-text">/form view callable</span><a class="headerlink" href="#form-view-callable" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;form&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">form</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Fill out the form!&quot;</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Form was successfully submitted!&quot;</span>
            <span class="n">all_people</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># add person to the &quot;database&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="mi">422</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;There were errors in the form!&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;form.mako&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">:</span> <span class="n">form</span><span class="p">},</span>
            <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status_code</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div>
<p>On receiving a GET request, the view returns a 200 response with an empty form (and a friendly message!). On a POST request, the form will try to validate and add the submission to the &#8220;database&#8221;. If it does not validate, it will respond with a 422 (BAD) status and re-render the form template with the invalid data and errors.</p>
<p>The view will render the template regardless. It leaves how that response is rendered up to the page requesting it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">With a little extra elbow grease, this view callable can be expanded to pre-populate the form with an existing object from the &#8220;database&#8221; for an edit function!</p>
</div>
</div>
<div class="section" id="using-jquery-to-operate-the-form-html-snippets">
<h2>Using jQuery to Operate the Form HTML Snippets<a class="headerlink" href="#using-jquery-to-operate-the-form-html-snippets" title="Permalink to this headline">¶</a></h2>
<p>Since it&#8217;s up to the page to determine what happens when loading/submitting the form&#8217;s html snippet, some jQuery will operate that real nicely.</p>
<p>First the form needs to be loaded when document is &#8220;ready&#8221;:</p>
<div class="literal-block-wrapper container" id="jquery-load-empty-form-on-page-load">
<div class="code-block-caption"><span class="caption-text">jQuery load empty form on page load</span><a class="headerlink" href="#jquery-load-empty-form-on-page-load" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>	<span class="c1">// load the empty form</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
	  <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;${request.route_url(&#39;form&#39;)}&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">form_html</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#form_div&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">form_html</span><span class="p">);</span>  
	  <span class="p">});</span>
    <span class="p">});</span>
      
</pre></div>
</div>
</div>
<p>Note that the GET method (<code class="docutils literal"><span class="pre">$.get()</span></code>)is being used to get the empty form via AJAX.</p>
<p>Since the HTML used to render the form doesn&#8217;t exist by <code class="docutils literal"><span class="pre">$(document).ready()</span></code>, a global listener for the <code class="docutils literal"><span class="pre">document</span></code> needs to be set up, so any actions the page is listening for will be handled on DOM objects that haven&#8217;t necessarily been rendered yet.</p>
<div class="literal-block-wrapper container" id="jquery-ajax-form-submission-reloading">
<div class="code-block-caption"><span class="caption-text">jQuery AJAX form submission/reloading</span><a class="headerlink" href="#jquery-ajax-form-submission-reloading" title="Permalink to this code">¶</a></div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>    <span class="c1">// set the ajax properties for the form	</span>
	<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span> <span class="s1">&#39;#form_div form&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
	  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
	  <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#form_div form&quot;</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
	    <span class="nx">type</span><span class="o">:</span> <span class="nx">form</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">),</span>
		<span class="nx">url</span><span class="o">:</span> <span class="nx">form</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">),</span>
		<span class="nx">data</span><span class="o">:</span> <span class="nx">form</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(),</span>
		<span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
		  <span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>  <span class="c1">// reload whole page</span>
		<span class="p">},</span>
		<span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">){</span>
		  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#form_div&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>  <span class="c1">// change form HTML</span>
		<span class="p">}</span>
	  <span class="p">});</span>
	<span class="p">});</span>
</pre></div>
</div>
</div>
<p>On success (when the view callable&#8217;s status is <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code>), the AJAX request refreshes the whole page, because the list of all submissions is static to the template. Other setups may reload data differently.</p>
<p>On error (when the view callable&#8217;s status is <code class="docutils literal"><span class="pre">422</span> <span class="pre">BAD</span></code>), the AJAX handler uses the responseText (which is the new HTML snippet of the form with the invalid information and displayed error messages) and replaces the current form HTML with the new HTML.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Reminder</strong>: the burden of handling the HTML snippets is on the page &amp; not the view.</p>
</div>
</div>
<div class="section" id="full-example">
<h2>Full Example<a class="headerlink" href="#full-example" title="Permalink to this headline">¶</a></h2>
<p>Below is a full include of the example files.</p>
<div class="literal-block-wrapper container" id="form-as-separate-template-py-webapp-view-callables">
<div class="code-block-caption"><span class="caption-text">form_as_separate_template.py (Webapp &amp; view callables)</span><a class="headerlink" href="#form-as-separate-template-py-webapp-view-callables" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>

<span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render_to_response</span>
<span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>
<span class="kn">from</span> <span class="nn">wtforms</span> <span class="kn">import</span> <span class="n">Form</span><span class="p">,</span> <span class="n">StringField</span><span class="p">,</span> <span class="n">IntegerField</span>
<span class="kn">from</span> <span class="nn">wtforms.validators</span> <span class="kn">import</span> <span class="n">Required</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">NumberRange</span>


<span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>

    <span class="n">firstname</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="s2">&quot;First Name&quot;</span><span class="p">,</span>
            <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">Required</span><span class="p">(),</span> <span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="s2">&quot;Last Name&quot;</span><span class="p">,</span>
            <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">Required</span><span class="p">(),</span> <span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">NumberRange</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">99</span><span class="p">)])</span>
    <span class="n">phone_number</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="s2">&quot;Phone Number&quot;</span><span class="p">,</span> <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">7</span><span class="p">)])</span>


<span class="n">all_people</span> <span class="o">=</span> <span class="p">[]</span>


<span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;index.mako&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;people&quot;</span><span class="p">:</span> <span class="n">all_people</span><span class="p">}</span>


<span class="nd">@view_config</span><span class="p">(</span><span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;form&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">form</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Fill out the form!&quot;</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Form was successfully submitted!&quot;</span>
            <span class="n">all_people</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># add person to the &quot;database&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status_code</span> <span class="o">=</span> <span class="mi">422</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;There were errors in the form!&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;form.mako&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">:</span> <span class="n">form</span><span class="p">},</span>
            <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status_code</span>
    <span class="k">return</span> <span class="n">response</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_mako&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="s1">&#39;/form&#39;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">9999</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Starting server at http://localhost:9999&quot;</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="index-mako-html-page-template">
<div class="code-block-caption"><span class="caption-text">index.mako (HTML page template)</span><a class="headerlink" href="#index-mako-html-page-template" title="Permalink to this code">¶</a></div>
<div class="highlight-mako"><div class="highlight"><pre><span></span><span class="x">&lt;!DOCTYPE HTML&gt;</span>
<span class="x">&lt;html&gt;</span>

<span class="x">&lt;head&gt;</span>
<span class="x">  &lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js&quot;&gt;&lt;/script&gt;</span>

<span class="x">  &lt;script&gt;</span>
<span class="x">	// load the empty form</span>
<span class="x">    $(document).ready(function(){</span>
<span class="x">	  $.get(&quot;</span><span class="cp">${</span><span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">)</span><span class="cp">}</span><span class="x">&quot;, function(form_html) {</span>
<span class="x">	    $(&quot;#form_div&quot;).html(form_html);  </span>
<span class="x">	  });</span>
<span class="x">    });</span>
<span class="x">      </span>
<span class="x">    // set the ajax properties for the form	</span>
<span class="x">	$(document).on(&#39;submit&#39;, &#39;#form_div form&#39;, function(e){</span>
<span class="x">	  e.preventDefault();</span>
<span class="x">	  var form = $(&quot;#form_div form&quot;);</span>
<span class="x">      $.ajax({</span>
<span class="x">	    type: form.attr(&#39;method&#39;),</span>
<span class="x">		url: form.attr(&#39;action&#39;),</span>
<span class="x">		data: form.serialize(),</span>
<span class="x">		success: function(data) {</span>
<span class="x">		  location.reload();  // reload whole page</span>
<span class="x">		},</span>
<span class="x">		error: function(jqXHR, textStatus, errorThrown){</span>
<span class="x">		  $(&quot;#form_div&quot;).html(jqXHR.responseText);  // change form HTML</span>
<span class="x">		}</span>
<span class="x">	  });</span>
<span class="x">	});</span>

<span class="x">  &lt;/script&gt;</span>


<span class="x">&lt;/head&gt;</span>

<span class="x">&lt;body&gt;</span>
<span class="x">  &lt;h1&gt;Form as a Separate Template&lt;/h1&gt;</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">people</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;h2&gt;People&lt;/h2&gt;</span>
<span class="x">    &lt;ul&gt;</span>
      <span class="cp">%</span> <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">people</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span>
<span class="x">          </span><span class="cp">${</span><span class="n">person</span><span class="p">[</span><span class="s1">&#39;firstname&#39;</span><span class="p">]</span><span class="cp">}</span><span class="x"> </span><span class="cp">${</span><span class="n">person</span><span class="p">[</span><span class="s1">&#39;lastname&#39;</span><span class="p">]</span><span class="cp">}</span><span class="x"> - Age: </span><span class="cp">${</span><span class="n">person</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="cp">}</span><span class="x"></span>
<span class="x">      	Phone #: </span><span class="cp">${</span><span class="n">person</span><span class="p">[</span><span class="s1">&#39;phone_number&#39;</span><span class="p">]</span><span class="cp">}</span><span class="x"></span>
<span class="x">        &lt;/li&gt;</span>
      <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">    &lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>

<span class="x">  &lt;div id=&quot;form_div&quot;&gt;</span>
<span class="x">  &lt;/div&gt;</span>
<span class="x">&lt;/body&gt;</span>

<span class="x">&lt;/html&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="form-mako-form-template">
<div class="code-block-caption"><span class="caption-text">form.mako (Form template)</span><a class="headerlink" href="#form-mako-form-template" title="Permalink to this code">¶</a></div>
<div class="highlight-mako"><div class="highlight"><pre><span></span><span class="x">&lt;form method=&quot;POST&quot; action=&quot;</span><span class="cp">${</span><span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">)</span><span class="cp">}</span><span class="x">&quot;&gt;</span>
<span class="x">  &lt;p&gt;</span><span class="cp">${</span><span class="n">message</span><span class="cp">}</span><span class="x">&lt;/p&gt;</span>

<span class="x">  </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">label</span><span class="cp">}</span><span class="x"> - </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="p">()</span><span class="cp">}</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
	  <span class="cp">%</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">firstname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span><span class="cp">${</span><span class="n">error</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
	  <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">	&lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="x">  &lt;br/&gt;</span>

<span class="x">  </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">lastname</span><span class="o">.</span><span class="n">label</span><span class="cp">}</span><span class="x"> - </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">lastname</span><span class="p">()</span><span class="cp">}</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">lastname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
	  <span class="cp">%</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">lastname</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span><span class="cp">${</span><span class="n">error</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
	  <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">	&lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="x">  &lt;br/&gt;</span>

<span class="x">  </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">label</span><span class="cp">}</span><span class="x"> - </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="p">()</span><span class="cp">}</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
	  <span class="cp">%</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span><span class="cp">${</span><span class="n">error</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
	  <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">	&lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="x">  &lt;br/&gt;</span>

<span class="x">  </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">phone_number</span><span class="o">.</span><span class="n">label</span><span class="cp">}</span><span class="x"> - </span><span class="cp">${</span><span class="n">form</span><span class="o">.</span><span class="n">phone_number</span><span class="p">()</span><span class="cp">}</span>
  <span class="cp">%</span> <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">phone_number</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
	  <span class="cp">%</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">phone_number</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span><span class="x"></span>
<span class="x">        &lt;li&gt;</span><span class="cp">${</span><span class="n">error</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
	  <span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">	&lt;/ul&gt;</span>
  <span class="cp">%</span><span class="k"> endif</span><span class="x"></span>
<span class="x">  &lt;br/&gt;</span>

<span class="x">  &lt;input type=&quot;submit&quot; value=&quot;submit&quot;/&gt;</span>
<span class="x">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Separate Template for Rendering Forms</a><ul>
<li><a class="reference internal" href="#form-html-snippets-as-templates">Form HTML Snippets as Templates</a></li>
<li><a class="reference internal" href="#the-view-callable-that-serves-the-form-html-snippet">The View Callable That Serves the Form HTML Snippet</a></li>
<li><a class="reference internal" href="#using-jquery-to-operate-the-form-html-snippets">Using jQuery to Operate the Form HTML Snippets</a></li>
<li><a class="reference internal" href="#full-example">Full Example</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../mako/mako.html">mako</a><ul>
      <li>Previous: <a href="../pyramid_bootstrap/bootstrap_form_messages/bootstrap_form_messages.html" title="previous chapter">Bootstrap Form Validation States</a></li>
      <li>Next: <a href="../../unittest/unittest.html" title="next chapter">unittest</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/python_libraries/pyramid/form_as_separate_template/form_as_separate_template.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Maxwell G. Brown.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../../../_sources/python_libraries/pyramid/form_as_separate_template/form_as_separate_template.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>